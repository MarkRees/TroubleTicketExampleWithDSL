//Automatically Generated by myParser() Sun Aug 10 14:36:20 EDT 2014

package org.drools.examples.troubleticket
//

//hey, the imports can appear anywhere !
import org.drools.examples.troubleticket.Customer;
import org.drools.examples.troubleticket.Ticket;



rule "New Ticket2"
    salience 10
    when
       customer : Customer( )   ticket : Ticket( c: customer == customer, status == "New" )
    then
       System.out.println("New ticket... "+c);
end



rule "Silver Priorty"
    //if after a certain time, we still have an issue, then escalate
    duration 3000
    when
        customer : Customer(subscription == "Silver") ticket : Ticket( customer == customer, status == "New")

    then
        ticket.setStatus("Escalate");update(ticket);System.out.println(ticket);
end

rule "Gold Priority"
    duration 1000
    when
        customer : Customer(subscription == "Gold") ticket : Ticket( customer == customer, status == "New")
    then
        ticket.setStatus("Escalate");update(ticket);System.out.println(ticket);
end

rule "Platinum Priority"
    //we don't want to make the high rollers wait !
    when
        customer : Customer(subscription == "Platinum") ticket : Ticket( customer == customer, status == "New")
    then
        ticket.setStatus("Escalate");update(ticket);System.out.println(ticket);
end



rule "Escalate"
    when
        customer : Customer( )   ticket : Ticket( c: customer == customer, status == "Escalate" )
    then
        sendEscalationEmail( customer, ticket );
end

rule "Done"
    when
        customer : Customer( )   ticket : Ticket( c: customer == customer, status == "Done" )
    then
        System.out.println("Done "+c);
end

// This is the same as the non DSL version. This could be kept in another file of course.
function void sendEscalationEmail( Customer customer, Ticket ticket ) {
    System.out.println( "Email : " + ticket );
}

